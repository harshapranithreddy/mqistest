<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Rang Barse Cover Flow</title>
  <link rel="icon" href="media/other/logo.png" />
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/gsap@3.7.0/dist/gsap.min.js"></script>
  <script src="https://unpkg.com/gsap@3.7.0/dist/ScrollTrigger.min.js"></script>
  <script src="https://unpkg.com/gsap@3.7.0/dist/Draggable.min.js"></script>
  <style>
    body {
      margin: 0;
      background: radial-gradient(ellipse at bottom, #1B2735 0%, #090A0F 100%);
      overflow: hidden;
      font-family: 'Poppins', sans-serif;
    }
    .box {
      transform-style: preserve-3d;
      position: absolute;
      top: 50%;
      left: 50%;
      height: 200px;
      width: 200px;
      display: none;
    }
    .box img {
      height: 100%;
      width: 100%;
      object-fit: cover;
      border-radius: 12px;
    }
    .boxes {
      height: 100vh;
      width: 100%;
      overflow: hidden;
      position: absolute;
      transform-style: preserve-3d;
      perspective: 800px;
      touch-action: none;
    }
    .controls {
      position: absolute;
      top: 70%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 300;
    }
    .scroll-icon {
      position: fixed;
      top: 1rem;
      right: 1rem;
      color: white;
    }
  </style>
</head>
<body>

<!-- Starry Background -->
<div id="space-bg"></div>

<!-- Logo top-left -->
<header class="w-full z-50 py-4 px-6 md:px-12 bg-black bg-opacity-50 backdrop-blur-md">
  <div class="max-w-7xl mx-auto flex items-center">
    <a href="index.html" class="flex items-center group">
      <img src="media/other/logo.png" alt="MQIS Logo" class="w-12 h-12 object-contain mr-3 group-hover:scale-105 transition duration-200">
      <span class="text-xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-red-400 to-red-600 group-hover:text-red-500 transition">MQIS</span>
    </a>
  </div>
</header>

<!-- Cover Flow Container -->
<div class="boxes"></div>
<div class="controls">
  <button class="prev">Previous</button>
  <button class="next">Next</button>
</div>

<!-- Scroll Hint Icon -->
<svg class="scroll-icon" viewBox="0 0 24 24" fill="currentColor" height="30">
  <path d="M20 6H23L19 2L15 6H18V18H15L19 22L23 18H20V6Z"/>
</svg>

<!-- GSAP & Cover Flow Logic -->
<script>
  gsap.registerPlugin(ScrollTrigger, Draggable);

  const COVERS = [
    "media/gallery/rangbarse/1.jpg",
    "media/gallery/rangbarse/2.jpg",
    "media/gallery/rangbarse/3.jpg",
    "media/gallery/rangbarse/4.jpg",
    "media/gallery/rangbarse/5.jpg",
    "media/gallery/rangbarse/6.jpg",
    "media/gallery/rangbarse/7.jpg",
    "media/gallery/rangbarse/8.jpg",
    "media/gallery/rangbarse/9.jpg",
    "media/gallery/rangbarse/10.jpg"
  ];

  const container = document.querySelector('.boxes');
  COVERS.forEach((src, i) => {
    const box = document.createElement('div');
    box.classList.add('box');
    const img = document.createElement('img');
    img.src = src;
    box.appendChild(img);
    container.appendChild(box);
  });

  const BOXES = gsap.utils.toArray('.box');
  gsap.set(BOXES, { yPercent: -50 });
  gsap.set('.box', { display: 'block' });

  let iteration = 0;
  const STAGGER = 0.1;
  const LOOP = gsap.timeline({ repeat: -1, paused: true });
  const SHIFTS = [...BOXES, ...BOXES, ...BOXES];

  SHIFTS.forEach((BOX, i) => {
    const tl = gsap.timeline();
    tl.set(BOX, { xPercent: 250, rotateY: -50, opacity: 0, scale: 0.5 })
      .to(BOX, { opacity: 1, scale: 1, duration: 0.1 }, 0)
      .to(BOX, { opacity: 0, scale: 0.5, duration: 0.1 }, 0.9)
      .fromTo(BOX, { xPercent: 250 }, { xPercent: -350, duration: 1 }, 0)
      .fromTo(BOX, { rotateY: -50 }, { rotateY: 50, duration: 1 }, 0)
      .to(BOX, { z: 100, scale: 1.25, duration: 0.1, repeat: 1, yoyo: true }, 0.4)
      .fromTo(BOX, { zIndex: 1 }, { zIndex: 999, repeat: 1, yoyo: true, duration: 0.5 }, 0);
    LOOP.add(tl, i * STAGGER);
  });

  const cycleDuration = STAGGER * BOXES.length;
  const loopHead = gsap.fromTo(LOOP, { totalTime: cycleDuration }, {
    totalTime: `+=${cycleDuration}`,
    duration: 1,
    ease: 'none',
    repeat: -1,
    paused: true
  });

  const playhead = { position: 0 };
  const scrub = gsap.to(playhead, {
    position: 0,
    onUpdate: () => loopHead.totalTime(playhead.position % loopHead.duration()),
    duration: 0.25,
    ease: 'power3',
    paused: true
  });

  const scrollToPosition = pos => {
    scrub.vars.position = pos;
    scrub.invalidate().restart();
  };

  document.querySelector('.prev').addEventListener('click', () => scrollToPosition(playhead.position + 1));
  document.querySelector('.next').addEventListener('click', () => scrollToPosition(playhead.position - 1));
</script>

</body>
</html>
